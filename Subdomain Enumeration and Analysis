ğŸŒ Wildcard DNS Misconfiguration & Subdomain Takeover

(Bug Bounty / Recon Notes)

1ï¸âƒ£ ğŸ§© Wildcard DNS Misconfiguration
ğŸ” What Is It?

A Wildcard DNS misconfiguration exists when a domain resolves any random or non-existent subdomain to an IP address or external service.

Example:
    anything.domain.com
    random123.domain.com
    test-xyz.domain.com


â¡ï¸ All of them still resolve.
ğŸ‘€ What to Look For

âœ… Random or non-existent subdomains still resolve
âœ… DNS returns an IP address or CNAME for any subdomain
âœ… Presence of wildcard records like:
*.domain.com
âœ… CNAME pointing to third-party services such as:
AWS
Azure
Netlify
Vercel
GitHub Pages

âš ï¸ Error pages indicating misconfiguration:
â€œNo such appâ€
â€œDomain not configuredâ€
â€œUnclaimed siteâ€
ğŸ› ï¸ Useful Commands

Check whether random subdomains resolve:
dig random123.domain.com
nslookup test123.domain.com
dig test123.domain.com +short

ğŸ‘‰ If any random name resolves, wildcard DNS may exist.

2ï¸âƒ£ğŸ´â€â˜ ï¸  Subdomain Takeover

    âœ… What Is a Subdomain Takeover?
    A subdomain takeover occurs when:
    A subdomain points (via CNAME or A record) to a third-party service
    The resource on that service is deleted or unclaimed
    An attacker can claim the resource
    The attacker gains full control over the subdomain

ğŸ§­ Subdomain Takeover Methodology (Step-by-Step)

ğŸ”¹ Step 1: Subdomain Enumeration
    Find all subdomains of the target.
    subfinder -d domain.com -all -silent
    ğŸ”§ Optional tools:
        amass
        assetfinder
        findomain

ğŸ”¹ Step 2: Check Which Subdomains Are Alive
    Identify active subdomains.
    httpx -l subdomains.txt
    or 
    simple browser check.

ğŸ”¹ Step 3: Identify DNS Records (ğŸš¨ CRITICAL STEP)
    This step decides whether takeover is even possible.
    dig sub.domain.com
    
    ğŸ” Look for CNAME pointing to:
        *.amazonaws.com
        *.azurewebsites.net
        *.herokuapp.com
        *.netlify.app
        *.vercel.app
        *.github.io
        *.zendesk.com

âš ï¸ Important Rule:

No CNAME = usually no classic subdomain takeover

ğŸ”¹ Step 4: Automated Takeover Scanning
    Use tools to speed up detection.
    python3 takeover.py -l subdomains.txt
    or
    subjack -w subdomains.txt -ssl -t 50
    or
    nuclei -t takeover/

âš ï¸ Tools can give false positives.

ğŸ”¹ Step 5: Manual Verification (ğŸ”¥ MOST IMPORTANT)
    Always verify manually.
    Visit the subdomain in a browser and look for errors like:
        â€œNo such appâ€
        â€œThere isnâ€™t a GitHub Pages site hereâ€
        â€œDomain not foundâ€
        â€œProject does not existâ€

ğŸ”¹ Step 6: Confirm Takeover Possibility (Safely)
    Check:
    âœ… Is the service claimable?
    âœ… Is the name available on that platform?
    
    âš ï¸ Do NOT actually claim the resource unless the program explicitly allows it.
    
    ğŸ“Œ Summary Workflow
    
        Enumerate subdomains â†’ Identify third-party CNAMEs â†’ Verify unclaimed services manually â†’ Confirm takeover feasibility â†’ Report responsibly.
        
        ğŸ§ª Example Analysis (Real Output)
        DNS Output
        ANSWER SECTION:
        blog.stylestry.com. 300 IN A 172.67.75.96
        blog.stylestry.com. 300 IN A 104.26.2.79
        blog.stylestry.com. 300 IN A 104.26.3.79

        ğŸ” Analysis:-
        These are A records, not CNAME
        The subdomain points directly to IP addresses
        IPs belong to Cloudflare
        ğŸŒ External Third-Party Service?
        âŒ No (for takeover purposes)
        Cloudflare IPs are not claimable.
        ğŸ’£ Is Subdomain Takeover Possible?
        âŒ NO â€” Not possible

        Check	Result
        CNAME present	âŒ No
        External service	âŒ No
        Unclaimed resource	âŒ No
        Claimable by attacker	âŒ No

â¡ï¸ This subdomain is NOT vulnerable to takeover

âš ï¸ Key Takeaway (Burn This Into Memory ğŸ”¥)

No CNAME = No classic subdomain takeover



3ï¸âƒ£ ğŸ” Analyzing Subdomain Permutations & Typosquats
ğŸ“Œ What Does It Mean?
    Analyzing subdomain permutations and typosquats means searching for subdomains created due to:
    Spelling mistakes
    Variations of valid subdomains
    Alternate naming patterns
    These subdomains may be:
        âŒ Unused
        âš ï¸ Misconfigured
        ğŸ•°ï¸ Forgotten
        ğŸ’£ Vulnerable to takeover
        ğŸ”“ Exposed services

ğŸ§­ Methodology (Step-by-Step)

ğŸ”¹ Step 1: Start with Known Subdomains
    Collect valid subdomains from recon tools, such as:
        api.domain.com
        admin.domain.com
        login.domain.com
    These act as the base input for permutations.

ğŸ”¹ Step 2: Generate Permutations & Typos
    Create variations and typo-based subdomains using tools like:
        dnsgen
        gotator
        altdns
    ğŸ“Ÿ Example Command
    dnsgen subs.txt > permuted.txt
This generates modified and misspelled subdomains.

ğŸ”¹ Step 3: Resolve Generated Subdomains
    Check which generated subdomains actually exist in DNS:
        dnsx -l permuted.txt
    Only resolved subdomains move to the next step.

ğŸ”¹ Step 4: Analyze the Results
    Manually analyze resolved subdomains for:
    ğŸ§ª Staging / dev environments
    ğŸŒ Third-party CNAMEs
    ğŸ•³ï¸ Forgotten services
    â— Error or misconfiguration pages
    These often lead to high-impact findings.

ğŸ§  One-Line Meaning (Easy to Remember)
Analyzing subdomain permutations and typosquats means systematically finding and testing misspelled or modified subdomains to discover hidden, forgotten, or vulnerable services.
