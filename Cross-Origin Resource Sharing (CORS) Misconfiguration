1 üåê CORS Misconfiguration (Subdomains)
Cross-Origin Resource Sharing (CORS) Misconfiguration

üìñ Short Description
CORS misconfiguration happens when a subdomain allows cross-origin requests from untrusted origins, potentially exposing sensitive data to attackers.

üß≠ Methodology
1Ô∏è‚É£ Find All Subdomains
subfinder -d domain.com -all -silent > subs.txt

2Ô∏è‚É£ Scan Using Automated Tool
Tool: Corsy-1.0-rc
python3 corsy.py -i subs.txt -t 10

Finds:
Access-Control-Allow-Origin: *
Reflected origins
Third-party allowed origins

3Ô∏è‚É£ Manual Testing
curl -i https://sub.domain.com -H "Origin: https://evil.com"

Check:
Access-Control-Allow-Origin
Access-Control-Allow-Credentials
‚ö†Ô∏è Risky if credentials are allowed.

nuclei_tool_for_cors_canning
nuclei -list sort_alive.txt -t /root/nuclei-templates-10.3.8/http/vulnerabilities/generic/cors-misconfig.yaml 

4Ô∏è‚É£ Exploitation Proof (PoC)
Use CORS PoC HTML (index.html) to verify:

Can attacker read response?
Are cookies sent?
If data is readable ‚Üí valid vulnerability

üéØ Key Point
CORS becomes serious only when sensitive data is accessible cross-origin

‚ö†Ô∏è Final Important Note
Even when CORS allows only a specific trusted origin, the target can still be vulnerable if that trusted/parent origin has issues like XSS, open redirect, or other client-side injections.
In this case, an attacker can run malicious JavaScript on the trusted origin, abuse the CORS trust, and read sensitive data from the target site.

üß† Key Takeaway:
CORS is only as secure as the origin it trusts.
If the trusted origin is compromised, CORS becomes exploitable even without wildcard (*) ACAO.
